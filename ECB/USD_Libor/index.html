<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latest 20 Data Entries and Line Chart</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            text-align: left;
            padding: 8px;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        .chart-container {
            width: 80%;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <h2>Latest 20 Data Entries</h2>
    <table id="data-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Label</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data rows will be inserted here by the JavaScript -->
        </tbody>
    </table>

    <div class="chart-container">
        <canvas id="data-chart"></canvas>
    </div>

    <!-- Include Chart.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>

    <script>
       const data = [
    { date: '2021/1/31', label: '2021Jan', value: '0.2236' },
    { date: '2021/2/28', label: '2021Feb', value: '0.1904' },
    { date: '2021/3/31', label: '2021Mar', value: '0.1896' },
    { date: '2021/4/30', label: '2021Apr', value: '0.1852' },
    { date: '2021/5/31', label: '2021May', value: '0.1525' },
    { date: '2021/6/30', label: '2021Jun', value: '0.1328' },
    { date: '2021/7/31', label: '2021Jul', value: '0.1308' },
    { date: '2021/8/31', label: '2021Aug', value: '0.1245' },
    { date: '2021/9/30', label: '2021Sep', value: '0.1227' },
    { date: '2021/10/31', label: '2021Oct', value: '0.1272' },
    { date: '2021/11/30', label: '2021Nov', value: '0.1589' },
    { date: '2021/12/31', label: '2021Dec', value: '0.2066' },
    { date: '2022/1/31', label: '2022Jan', value: '0.2541' },
    { date: '2022/2/28', label: '2022Feb', value: '0.4318' },
    { date: '2022/3/31', label: '2022Mar', value: '0.8397' },
    { date: '2022/4/30', label: '2022Apr', value: '1.0997' },
    { date: '2022/5/31', label: '2022May', value: '1.4667' },
    { date: '2022/6/30', label: '2022Jun', value: '1.9689' },
    { date: '2022/7/31', label: '2022Jul', value: '2.6105' },
    { date: '2022/8/31', label: '2022Aug', value: '2.9521' },
    { date: '2022/9/30', label: '2022Sep', value: '3.4494' },
    { date: '2022/10/31', label: '2022Oct', value: '4.1407' },
    { date: '2022/11/30', label: '2022Nov', value: '4.6493' },
    { date: '2022/12/31', label: '2022Dec', value: '4.739' },
    { date: '2023/1/31', label: '2023Jan', value: '4.8051' },
    { date: '2023/2/28', label: '2023Feb', value: '4.8879' },
    { date: '2023/3/31', label: '2023Mar', value: '5.0518' },
    { date: '2023/4/30', label: '2023Apr', value: '5.2513' },
    { date: '2023/5/31', label: '2023May', value: '5.3779' },
    { date: '2023/6/30', label: '2023Jun', value: '5.5263' },
    { date: '2023/7/31', label: '2023Jul', value: '5.5844' },
    { date: '2023/8/31', label: '2023Aug', value: '5.6427' },
    { date: '2023/9/30', label: '2023Sep', value: '5.6615' },
    { date: '2023/10/31', label: '2023Oct', value: '5.6597' },
    { date: '2023/11/30', label: '2023Nov', value: '5.6395' },
    { date: '2023/12/31', label: '2023Dec', value: '5.6274' },
    { date: '2024/1/31', label: '2024Jan', value: '5.5811' },
    { date: '2024/2/29', label: '2024Feb', value: '5.5793' }
];


        const updateTable = (dataEntries) => {
            const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = ''; // Clear existing table data

            // Take the last 20 entries
            const latestData = dataEntries.slice(-20);
            latestData.forEach((row) => {
                let tr = document.createElement('tr');
                tr.innerHTML = `<td>${row.date}</td><td>${row.label}</td><td>${row.value}</td>`;
                tableBody.appendChild(tr);
            });
        };

        const updateChart = (dataEntries) => {
            const ctx = document.getElementById('data-chart').getContext('2d');
            const labels = dataEntries.map(entry => entry.label);
            const values = dataEntries.map(entry => entry.value);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Value over time',
                        data: values,
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        };

        document.addEventListener('DOMContentLoaded', () => {
            updateTable(data);
            updateChart(data);
        });
    </script>
</body>
</html>
